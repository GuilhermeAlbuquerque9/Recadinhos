<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Recadinhos™ — Criar conta ou Entrar</title>
</head>
<body>

<table>
  <tr>
    <h1><strong>Recadinhos™</strong></h1>
  </tr>
  <tr>
    <td>
      [ <a href="index.html">🏠 Início</a> ]
      [ <a href="Sobre.html">📄 Sobre</a> ]
      [ <a href="Criar_conta.html">🙂 Criar conta</a> ]
      [ <a href="Postagens.html">📧 Postagens</a> ]
      [ <a href="Sair.html">❌ Sair</a> ]
    </td>
  </tr>
</table>

<h1>Criar conta</h1>

<form id="formCriar">
  <label for="usuario">Usuário (sem espaços):</label><br>
  <input type="text" id="usuario" name="usuario" maxlength="20" required><br><br>

  <label for="nome">Nome completo:</label><br>
  <input type="text" id="nome" name="nome" maxlength="60" required><br><br>

  <label for="senha">Senha:</label><br>
  <input type="password" id="senha" name="senha" required><br><br>

  <input type="submit" value="Criar Conta">
</form>

<br><hr><br>

<h1>Entrar</h1>

<form id="formLogin">
  <label for="loginUsuario">Usuário:</label><br>
  <input type="text" id="loginUsuario" name="loginUsuario" maxlength="20" required><br><br>

  <label for="loginSenha">Senha:</label><br>
  <input type="password" id="loginSenha" name="loginSenha" required><br><br>

  <input type="submit" value="Entrar">
</form>

<p>Após criar ou entrar, você será redirecionado para o mural de <a href="Postagens.html">Recadinhos</a>.</p>

<script>
// 🔗 COLE SUA API AQUI!
const API_URL = "https://script.google.com/macros/s/AKfycbxFfDNxXYIRRE5JXTqro_09yMapNPyosCLKeSfeuN1KfXtK_Ez1XDJBMYwlNmJlNRizYA/exec";

// ====== CRIAR CONTA ======
document.getElementById('formCriar').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const usuario = document.getElementById('usuario').value.trim();
  const nome = document.getElementById('nome').value.trim();
  const senha = document.getElementById('senha').value.trim();

  if (!usuario || !nome || !senha) {
    alert('Por favor, preencha todos os campos!');
    return;
  }

  try {
    const resposta = await fetch(API_URL, {
      method: 'POST',
      body: JSON.stringify({ action: 'criarConta', usuario, nome, senha }),
    });

    const dados = await resposta.json();
    if (dados.status === 'ok') {
      localStorage.setItem('usuario', usuario);
      alert('Conta criada com sucesso! Bem-vindo(a), ' + nome + '!');
      window.location.href = 'Postagens.html';
    } else {
      alert('Erro: ' + dados.mensagem);
    }
  } catch (erro) {
    alert('Falha ao conectar ao servidor: ' + erro);
  }
});

// ====== LOGIN ======
document.getElementById('formLogin').addEventListener('submit', async (e) => {
  e.preventDefault();

  const usuario = document.getElementById('loginUsuario').value.trim();
  const senha = document.getElementById('loginSenha').value.trim();

  try {
    const resposta = await fetch(API_URL, {
      method: 'POST',
      body: JSON.stringify({ action: 'login', usuario, senha }),
    });

    const dados = await resposta.json();
    if (dados.status === 'ok') {
      localStorage.setItem('usuario', usuario);
      alert('Bem-vindo(a) de volta, ' + usuario + '!');
      window.location.href = 'Postagens.html';
    } else {
      alert('Usuário ou senha incorretos.');
    }
  } catch (erro) {
    alert('Erro ao conectar: ' + erro);
  }
});
</script>

</body>
</html>
